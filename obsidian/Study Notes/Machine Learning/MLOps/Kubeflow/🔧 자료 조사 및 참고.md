
- kubeflow란 쿠버네티스를 이용한 ML 툴킷


- K8S 온프레미스 환경에서 설치(zero부터 쿠버네티스 환경 구축): https://bluecheat.medium.com/%EC%98%A8%ED%94%84%EB%A0%88%EB%AF%B8%EC%8A%A4-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%EC%97%86%EC%9D%B4-%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0-b2f0e1be96dd

- minikube 클러스트
	- 단일노드로 구성되어 있으며, 해당 노드가 마스터 노드 및 워커 노드의 역할을 모두 수행
	- 로컬 실습에 적합한 배포판.

- 쿠버네티스 pod이란 하나 이상의 컨테이너를 묶은 가장 작은 배포 단위
- <u>Cert-manager</u>: 인증서 관리자. HTTPS 또는 내부 서비스(pod)끼리의 암호화 통신에 필요. pod끼리 대화할때의 암호화 통신을 mTLS(상호 TLS)라고 함. 수십-수백 개의 파드에게 각각 신분증을 발급하고 관리
- <u>Istio</u>: kubeflow는 내부적으로 istio를 사용하여 k8s 위에 올라간 서비스들을 연결하고 있음.
	- 서비스 메시(service mesh): MSA에서 마이크로서비스간 통신을 제어하고 관리할 수 있는 인프라계층, MSA 시스템의 규모가 커질수록 관리가 복잡 → ervice mesh를 통해 어플리케이션 계층에서 해결하지 않고, 코드 수정없이 인프라 레벨에서 해결할 수 있음
	- istio는 <u>service mesh</u>를 구현할 수 있는 오픈소스
	- 쿠버네티스 환경에 구축된 어플리케이션이 복잡해져서 기본 쿠버네티스 컨트롤러만으로는 커버하기 힘들어질 때 많은 경우 istio를 도입하여 해결
	- ![[Pasted image 20251205104849.png]]

- kubeflow pipeline을 사용하려면 k8s가 선행되어야 하는데, 단일 노드로 구성한다고 해도 상당한 메모리 자원을 소요
	- 경량 쿠버네티스 사용 필요
		- <u>MicroK8s</u> 또는 <u>K3s</u>
		- 참고블로그: https://seokii.tistory.com/203
			- 도커 설치 → kubectl (명령줄 도구 CLI) 설치 → k3s 설치
			- 기본 모듈 설치 (Helm, Kustomize)
				- <u>Helm</u>: Kubernetes용 패키지 매니저. 
				- <u>Kustomize</u>: 쿠버네티스 리소스(yaml 파일)를 변경하지 않고 필드를 재정의하여 새로운 쿠버네티스 리소스를 생성하는 도구![[obsidian/Attachments/Pasted image 20251204171746.png]]
			- kubeflow 설치: kustomize를 이용해 kubeflow 설치
			- Cert-Manager 설치
			- Istio 설치
				- Istio CRD와 namespace를 설치
			- Dex 설치 (인증시스템)
				- 참고: https://blog.naver.com/alice_k106/221598325656
			- OIDC AuthService 설치
			- 위 과정을 모두 끝낸 다음, Kubeflow 접속 가능


### Kubeflow Fairing (페어링)
- 페어링이란 쿠브플로우가 설치된 환경에서 ML 모델의 학습과 배포를 도와주는 파이썬 패키지
- 3가지 개념, Preprocessor, Builder, Deployer
- 전처리기는 <u>도커 이미지</u>로 패키지화할 대상을 지정 (컨테이너 이미지를 만들 때, 이미지 생성에 필요한 정보들을 정의)
- 빌더: 전처리기가 생성한 패키지를 도커 이미지화 시키는 역할, 제공하는 3가지 빌더
	- append: 도커 클라이언트를 사용하지 않고, 파이썬 라이브러리 containerregistry를 사용. 도커를 사용하지 않는 환경에서 사용
	- docker: 로컬 도커 클라이언트로 도커 이미지를 생성
	- cluster: 쿠버네티스 클러스터에서 사용할 컨테이너 이미지를 생성