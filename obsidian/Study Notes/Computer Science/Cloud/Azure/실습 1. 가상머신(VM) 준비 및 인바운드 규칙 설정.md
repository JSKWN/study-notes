VM은 단순하게 쇼핑몰이나 게시판 등의 실제 앱이 동작하는서버라고 할 수 있으며, 구체적으로는 아래 역할을 한다.
- 웹 서버: 사용자가 웹 브라우저를 통해 접속했을 때, 가장 먼저 요청을 받는 서버이며, HTML, CSS, JS 등, 미리 만들어진 정적 콘텐츠를 전달)
- 웹 애플리케이션: 웹 서버가 처리할 수 없는 복잡한 요청을 처리하는 서버. 실시간 데이터 처리 및 결과 생성 (동적 콘텐츠, 로그인 및 개인 페이지 등)
- 데이터베이스

# 가상머신 생성

가상머신 - 만들기
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_db_and_webserver/image-9.png]]

## 1. 기본 사항 탭
기본 사항은 다음 영역으로 구성된다.
- 프로젝트 정보
- 인스턴스 정보
- 관리자 계정
- 인바운드 포트 규칙

![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_db_and_webserver/image-15.png]]

- 리소스 그룹은 Azure 상에서 개발되는 특정 서비스와 관련된 리소스를 묶는 논리적 개념
	- Azure를 처음 사용하는 경우, 리소스 그룹이 생성되어 있지 않으므로 새로운 리소스 그룹 이름을 입력 (KNOU_MALL)

- 인스턴스 정보 영역에서는 VM에 대한 상세한 정보.
	- 지역: 데이터센터의 위치
	- 가용성 옵션: 유사시 대비, 중복 또는 복제한 서버를 만들어 놓는것
	- 이미지: 하드웨어가 만들어지자 마자 설치되는 운영체제(OS)
	- 크기: 서버의 CPU 및 RAM 성능 사양
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_db_and_webserver/image-16.png]]
- 관리자 계정
	- 생성된 VM에 시스템 관리자로 접속할 방법을 지정
	- SSH 공개키 방법: VM에 접속할 때, 서버가 보내 온 공개 키와, 사용자가 가지고 있는 비밀 키의 관계가 일치하면 로그인을 허용
		- SSH 인증 방식의 경우, “사용자 이름” 및 “키 쌍 이름” 입력 필요
	- 암호 방법: 로그인 ID 및 비밀번호를 입력하는 방식

- 인바운드 포트 규칙: VM에 전달되는 포트를 결정
	- 인바운드(in-bound)란 외부에서 생성하여 VM에 전달되는 정보 (외부에서 접속할 포트)
		- VM이 생성되면 **외부에서 VM에 접속하기 위해 호스트 주소와 포트를 지정**하여 접속할 수 있는데, 이를 인바운드 포트라고 함
		- 기본적으로 SSH 22번 포트가 선택되어 있는데, 웹 서버 역할을 하려면 HTTP(80)을 선택
	- 아웃바운드(out-bound)는 VM에서 외부의 시스템에 전달되는 정보
	- 

## 2. 디스크 탭
VM이 사용할 기본 디스크 크기와 유형을 지정. VM은 기본적으로 OS가 사용할 디스크와, OS 외의 정보를 저장할 데이터 디스크를 지정할 수 있음.
디스크 정보는 크게 다음 세가지 영역으로 구분됨
- VM 디스크 암호화(VM disk encryption) 영역
- OS 디스크 영역
- 데이터 디스크 영역

![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_db_and_webserver/image-17.png]]

- OS 디스크 영역은 OS 디스크에 대한 크기와 종류를 선택 (현재 표준 HDD로 설정)
	- ‘VM으로 삭제’는 VM 삭제 시 OS 디스크도 동시에 삭제할 것인지를 결정
- 데이터 디스크 영역
	- 데이터를 저장할 추가적인 디스크가 필요한 경우, 별도의 비용을 지불하고 데이터 디스크를 생성 및 추가. (이번에는 대용량 데이터 필요없으므로 사용 X)

## 3. 네트워킹 탭
NIC(네트워크 인터페이스 카드)를 설정하여 VM에 대한 네트워크 연결을 정의하는 단계.
이 단계에서는 보안 그룹 규칙을 사용하여 포트, 인바운드 및 아웃바운드 연결 등의 설정을 제어할 수 있음.

가상 네트워크는 “네트워크 인터페이스 영역”과 “부하 분산 영역”으로 구성됨
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-19.png]]
- 네트워크 인터페이스: VM이 네트워크 영역 및 오픈 포트를 지정
	- 가상 네트워크: Azure에서 논리적으로 격리되는 네트워크. IP 주소 범위, 서브넷, 라우팅 테이블,  게이트웨이 및 보안 설정을 구성.
	- 서브넷: 가상 네트워크의 일정한 IP 주소 범위를 말함. (가상 머신을 서로 격리하거나, 인터넷망에서 네트워클르 격리하는데 사용하기도 함)
	- 공용 IP: 가상 네트워크 밖에 있는 호스트에서 VM에 접속할 수 있는 IP 주소가 필요.
	- NIC 네트워크 보안 그룹: 가상 네트워크와 다른 네트워크 간의 인바운드 및 아웃바운드에 대한 접근을 설정하는 방법 제공
	- 공용 인바운드 포트: 가상 머신으로 접근을 허용하는 공용 포트를 지정.
	- VM 삭제시 공용 IP 및 NIC 삭제: VM 삭제 시 VM에 연결된 공용 IP와 NIC를 삭제할 것인지. 원래는 서비스 연속성을 위해 타 VM에 할당하여 지속적으로 사용가능하나, 현재 실습은 체크.
	- 가속화된 네트워킹 사용: 짧은 대기시간 및 높은 처리속도를 가능하게 하는 옵션
![[image-20.png]]
- 부하 분산 영역: 생성할 VM을 동작 중인 부하 분산 솔루션에 배치할 지를 지정함 (로드 밸런싱과 관련)


## 4. 고급 탭
![[image-21.png]]
cloud-init: yaml을 이용하여 VM이 생성된 직후 계정 생성 및 프로그램 설치 등 자동화 하는 스크립트
```
#cloud-config
package_upgrade: true
packages:
  - python3
  - python3-pip
  - build-essential
runcmd:
  - python3 -m pip install flask waitress
  - cd /opt
  - git clone https://github.com/jaehwachung/cloud_computing.git
  - cd /opt/cloud_computing/knou_mall/front_page
  - python3 shop_main.py

```

![[image-22.png]]


# 인바운드 포트 규칙 설정

내 IP 주소에서 SSH 포트에 연결을 허용하는 인바운드 규칙을 추가하여, 해당 IP 주소에서 가상 머신에 접속 가능하도록 설정

## 가상머신 개요 페이지 - 네트워킹 메뉴
![[image-23.png]]

내 아이피 주소: 14.47.103.207

![[image-24.png]]
![[image-25.png]]
- 포트 규칙 만들기 → 인바운드 보안 규칙 추가
	- 소스: My IP adress 선택
	- 대상 주소 ANy
	- 서비스: SSH