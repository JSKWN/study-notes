7개의 탭으로 구성


## 기본 사항 탭
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-1.png]]

- SKU: 일종의 크기, 단위. 표준으로 사용
- 형식은 공개로 사용: 웹 서비스에 해당하는 로드밸런서 이므로. 먼저 사용자가 로드밸런서에 요청을 하게 되면, 로드밸런서가 idle상태에 있는 서버로 전달해 주게 됨
- 계층은 지역 (같은 지역에 있는 웹서버들로 배치)




## 프런트 엔드 IP 구성 탭
로드밸런서가 먼저 정보서비스 사용자의 요청을 받아야함. 로드밸런서도 공용 ip 주소가 필요함
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-2.png]]
+ \+ 프런트 엔드 IP 구성 추가 
+ 공용 IP 주소 새로 만듦
+ 라우팅 기본 설정은 MS 네트워크 내부에서 일어나도록

## 백 엔드 풀
로드 밸런서가 요청을 받았으면 이것을 어떤 웹서버가 처리할지 할당하게됨
가상머신의 그룹을 백 엔드 풀 (실질적으로 처리할 웹서버)


- \+ 백 엔드 풀 추가
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-4.png]]
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-3.png]]

## 인바운드 규칙
로드 밸런서가 요청을 받고, 처리할 웹서버에 전달할 텐데, 이를 어떻게 할 것인지를 정함

1. 부하 분산 규칙 추가
- 포트: 프론트 엔드로 들어오는 80 포트를 그대로 벡엔드에 80포트로 전달을 해줘야 함. 무조건 같아야 하는건 아니지만 실습의 경우는 80포트로 전달을 해줘야 백엔드에 있는 웹서버가 동작할 수 있음 

- 상태 프로브: 여러개의 가상머신 중에 어떤것이 유휴한 가상머신인지 알아야함. 그걸 어떻게 체크할 것인지 → 새로만들기 
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-8.png]]

![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-9.png]]
- 아웃바운드 SNAT: NAT은 Network Address Translation 네트워크 주소를 변경해주는것임. 외부에서 오는 공용 IP 접속요청을 내부 IP를 사용하는 리소스에 전달 → NAT, 역과정은 SNAT임. 우선은 권장
- 인바운드 NAT규칙은 추가 X

## 아웃바운드 규칙

별도 규칙 필요없음

바로 검토+만들기



## (배포 이후) 개요 페이지
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-10.png]]

## 프런트 엔드 IP 구성

![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-11.png]]

IP 주소 필요함, 해당 ip는 로드밸런서의 IP이나, 쇼핑몰 웹페이지로로 이동함
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-13.png]]

백엔드 풀 탭에서는 mall-vm1 서버 확인가능

## 인사이트 메뉴
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-12.png]]

## 백엔드 풀에,  기존 서버 추가하는 방법
기존에 있는 웹서버를 붙이는 방식, 아니면 새롭게 생성하면서 백엔드 풀에 넣는방식

mall-vm2(나는 retry1)을 집어넣음

가상머신 → mall-vm2 → 네트워킹 → 부하분산 → 부하분산 추가 (기존 항목)


![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-14.png]]


다시 부하분산(LB)의 백엔드 풀 확인, 항목이 하나 더 보임
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-15.png]]


## 새 가상머신 만들면서 추가하는 방법

mall-vm-3
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-17.png]]
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-16.png]]


### 여기서 부하 분산 옵션 확인가능
![[obsidian/Study Notes/Computer Science/Cloud/Azure/방송통신대학 실습이미지/img_load_balance/image-19.png]]
부하 분산 장치 선택 및 백 엔드 풀 선택

## 고급 탭에서 cloud-init 설정 필요함 (웹서버로서 동작하게 하려면)

DB도 붙여서 실행해야 동작함